<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Notes</title>
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background-color: #000;
      color: #fff;
      font-family: 'Fira Code', monospace;
      height: 100vh;
      display: none;
      flex-direction: column;
    }

    #notepad-container {
      display: flex;
      flex-direction: column;
      height: 100vh;
      width: 100%;
    }

    header {
      background-color: #111;
      padding: 1rem;
      font-size: 1rem;
      border-bottom: 1px solid #333;
    }

    .notepad {
      flex: 1;
      padding: 1.5rem;
      font-size: 0.95rem;
      line-height: 1.5;
      overflow-y: auto;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <div id="notepad-container">
    <header>
      ssh revardo@bastion-1.acad.opswerks.net | pw: Acad_student-revardo
    </header>

    <div class="notepad">
<h1>JENKINS_LABS</h1>

<h3 style="border-top: 1px dotted white;">Get Familiar with the Application</h3>
In this lab, we will deploy the go-webapp-sample app that we saw in the lecture. This sample application uses Echo as web application framework and Gorm as the backend database.

Which of the following commands is used to clone a git repository?
$ git clone &lt;repo-url&gt;

Clone this git repository under /home/bob.
$ cd /home/bob
$ git clone https://github.com/kodekloudhub/go-webapp-sample.git

Now let us deploy the sample app from the repository that we just cloned.
$ cd /home/bob/go-webapp-sample/
$ go run main.go &

You can now access the sample app using the Sample-App button located above the terminal.
You can login with the following username and password:
# username: test
# password: test

<h3 style="border-top: 1px dotted white;">Install Jenkins on a VM</h3>
Which of the following options best describes what Jenkins is?
- An Automation Server

What is CI/CD?
- CI/CD is the continuous integration and continuous delivery/deployment process.

Can we use Jenkins to automate routine system administration tasks?
- Yes

Which of the following packages is a prerequisite for installing Jenkins ?
- Java

Can we run Jenkins in a container ?
- Yes

Now let us install Jenkins on the centos-host machine and configure it to run on port 8090 instead of the default port 8080.
$ sudo yum install epel-release -y
$ sudo yum install fontconfig java-17-openjdk -y
$ sudo wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo --no-check-certificate
$ sudo rpm --import http://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key
$ sudo yum install jenkins -y

Edit /lib/systemd/system/jenkins.service file and change Jenkins port to 8090 by updating Environment="JENKINS_PORT=" variable value.
$ sudo vi /lib/systemd/system/jenkins.service
# Change Environment="JENKINS_PORT=8090" to [_PORT=8090]

$ sudo systemctl start jenkins
$ sudo systemctl status jenkins

Now, you should be able to access Jenkins using Jenkins button on the top bar. Complete its installation from UI and make sure to create first admin user as per details mentioned below:
$ sudo cat /var/lib/jenkins/secrets/initialAdminPassword    (password)
# install suggested plugins     [hit retry if some failed]
# Username: admin
# Password: Admin321
# Full name: Admin User
# E-mail address: admin@example.com

<h3 style="border-top: 1px dotted white;">Jenkins CLI</h3>

<h3 style="border-top: 1px dotted white;">Backup and Restore Jenkins</h3>

<h3 style="border-top: 1px dotted white;">Building a CD Pipelines</h3>




<h1 style="border-top: 5px dashed white;">KODEKLOUD_ENGINEERING</h1>

 
<h2 style="border-left: 5px dashed greenyellow; padding-left: 5px;">LEVEL 1</h2>


<h3 style="border-top: 1px dotted white;">Set Up Jenkins Server</h3>
The DevOps team at xFusionCorp Industries is initiating the setup of CI/CD pipelines and has decided to utilize Jenkins as their server. Execute the task according to the provided requirements:

1. Install jenkins on jenkins server using yum utility only, and start its service. You might face timeout issue while starting the Jenkins service, please refer this link for help.

2. Jenkin's admin user name should be theadmin, password should be Adm!n321, full name should be John and email should be john@jenkins.stratos.xfusioncorp.com.

Note:

1. For this task, access the Jenkins server by SSH using the root user and password S3curePass from the jump host.

2. After Jenkins server installation, click the Jenkins button on the top bar to access the Jenkins UI and follow on-screen instructions to create an admin user.

$ ssh root@jenkins      (S3cure)
$ yum install wget -y   (install wget package)
$ wget -O /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo   (download jenkins repo)
$ ls -l /etc/yum.repos.d/   (verify)
$ rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io-2023.key     (import)
$ yum install jenkins   (install jenkins package)
$ systemctl daemon-reload   (reload daemon)
$ systemctl start jenkins   (start jenkins) [error code]
$ yum install java-17-openjdk   (install java package)
$ systemctl start jenkins   (start jenkins)
$ systemctl status jenkins  (verify)
$ cat /var/lib/jenkins/secrets/initialAdminPassword (unlock jenkins)
# install suggested plugins     [hit retry if some failed]
# theadmin      (username)
# Adm!n321      (password)
# John          (fullname)
# john@jenkins.stratos.xfusioncorp.com  (email address)




<h3 style="border-top: 1px dotted white;">Install Jenkins Plugins</h3>
The Nautilus DevOps team has recently setup a Jenkins server, which they want to use for some CI/CD jobs. Before that they want to install some plugins which will be used in most of the jobs. Please find below more details about the task

1. Click on the Jenkins button on the top bar to access the Jenkins UI. Login using username admin and Adm!n321 password.

2. Once logged in, install the Git and GitLab plugins. Note that you may need to restart Jenkins service to complete the plugins installation, If required, opt to Restart Jenkins when installation is complete and no jobs are running on plugin installation/update page i.e update centre.

Note:

1. After restarting the Jenkins service, wait for the Jenkins login page to reappear before proceeding.

2. For tasks involving web UI changes, capture screenshots to share for review or consider using screen recording software like loom.com for documentation and sharing.

# Manage Jenkins > Plugins > Available Plugins
# Select Git and Gitlab then install
# Restart Jenkins


<h3 style="border-top: 1px dotted white;">Configure Jenkins User Access</h3>
The Nautilus team is integrating Jenkins into their CI/CD pipelines. After setting up a new Jenkins server, they're now configuring user access for the development team, Follow these steps:

1. Click on the Jenkins button on the top bar to access the Jenkins UI. Login with username admin and password Adm!n321.

2. Create a jenkins user named yousuf with the passwordTmPcZjtRQx. Their full name should match Yousuf.

3. Utilize the Project-based Matrix Authorization Strategy to assign overall read permission to the yousuf user.

4. Remove all permissions for Anonymous users (if any) ensuring that the admin user retains overall Administer permissions.

5. For the existing job, grant yousuf user only read permissions, disregarding other permissions such as Agent, SCM etc.

Note:

1. You may need to install plugins and restart Jenkins service. After plugins installation, select Restart Jenkins when installation is complete and no jobs are running on plugin installation/update page.

2. After restarting the Jenkins service, wait for the Jenkins login page to reappear before proceeding. Avoid clicking Finish immediately after restarting the service.

3. Capture screenshots of your configuration for review purposes. Consider using screen recording software like loom.com for documentation and sharing.

# open jenkins web
# login admin
# Manage Jenkins > users > create user
# username: yousuf
# password: TmPcZjtRQx
# fullname: Yousuf
# Manage Jenkins > plugins > Available Plugins > Matrix Authorization Strategy > install > restart
# Manage Jenkins > Security > Authorization (select project-based matrix authorization strategy)
# Add user > yousuf
# overall: read
# job: read
# Save
# login to yousuf

<h3 style="border-top: 1px dotted white;">Organize Jenkins Jobs with Folders</h3>


<h3 style="border-top: 1px dotted white;">Configure Jenkins Job for Package Installation</h3>



 
<h2 style="border-left: 5px dashed greenyellow; padding-left: 5px;">LEVEL 2</h2>
 

<h3 style="border-top: 1px dotted white;">Jenkins Views</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Parameterized Builds</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Workspaces</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Database Backup Job</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Scheduled Jobs</h3>




<h2 style="border-left: 5px dashed greenyellow; padding-left: 5px;">LEVEL 3</h2>


<h3 style="border-top: 1px dotted white;">Jenkins Slave Nodes</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Project Security</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Build Images</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Deploy Pipeline</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Conditional Pipeline</h3>



 
<h2 style="border-left: 5px dashed greenyellow; padding-left: 5px;">LEVEL 4</h2>
 

<h3 style="border-top: 1px dotted white;">Jenkins Deployment Job</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Chained Builds</h3>


<h3 style="border-top: 1px dotted white;">Jenkins MR Jobs</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Multistage Pipeline</h3>


<h3 style="border-top: 1px dotted white;">Jenkins Setup Node App</h3>


<h4>Setting up your Jenkins instance</h4>
• SSH into the first instance (server) and create a folder named jenkins_home in the home directory.
• Execute the following command:
    $ docker run -p 8080:8080 -v ~/jenkins_home:/var/jenkins_home -d --name jenkins-server jenkins/jenkins:lts-jdk17

$ ssh username@&lt;SERVER_IP&gt;
$ sudo mkdir -p ~/jenkins_home
$ sudo chown $USER:$USER ~/jenkins_home (do this if sudoer)
$ docker run -p 8080:8080 -v ~/jenkins_home:/var/jenkins_home -d --name jenkins-server jenkins/jenkins:lts-jdk17

    # If you need to run this command again, delete the existing jenkins-server container first.
$ docker rm -f jenkins-server
$ docker run -p 8080:8080 -v ~/jenkins_home:/var/jenkins_home -d --name jenkins-server jenkins/jenkins:lts-jdk17

• Open your browser and go to: [IP of Server]:8080 to visit your Jenkins instance. Follow the first-time instructions:
$ http://&lt;SERVER_IP&gt;:8080
$ cat ~/jenkins_home/secrets/initialAdminPassword

    # The secrets folder is located at ~/jenkins_home
    # Install the default plugins
    # Use your instance’s username and password to create your first Jenkins user

<h4>Setting up the agent</h4>
$ ssh &lt;username&gt;@&lt;AGENT_SERVER_IP&gt;
$ ls /home/&lt;username&gt;   (check if not existed proceed to next to create)
$ sudo mkdir -p /home/&lt;username&gt;
$ sudo chown &lt;username&gt;:&lt;username&gt; /home/&lt;username&gt;

$ java -version (check if java is installed)
# If not installed
$ sudo apt update && sudo apt install -y openjdk-17-jdk   (Ubuntu/Debian)
$ sudo yum install -y java-17-openjdk (CentOS/RHEL)

# Test SSH from Jenkins server to agent
$ ssh &lt;username&gt;@&lt;AGENT_SERVER_IP&gt;  (if login no error: good!)

• Under Manage Jenkins > Credentials, create a username:password credential with your instance’s username and password.
# Manage Jenkins → Credentials
# Click on (global) → Add Credentials
# Select:
    • Kind: Username with password
    • Username: (your agent server username)
    • Password: (your agent server password)
    • ID: (optional, e.g., agent-login — easier to identify later)
# Click OK

• Under Manage Jenkins > Nodes (or go to [IP of Server]:8080/computer), create a new permanent agent named linux-node with the following settings:
# Manage Jenkins → Nodes or (http://&lt;JENKINS_SERVER_IP&gt;:8080/computer)
# Click New Node
    • Node name: linux-node
    • Select Permanent Agent
# Click OK

    # Configure the Node (Fill in these settings)
    • Executors: 1
    • Remote root directory: /home/[username]/
    • Usage: Use this node as much as possible
    • Launch method: SSH
    • Host: IP or hostname of your second instance (agent)
    • Credentials: Use the credential created above
    • Host Key Verification Strategy: Non verifying Verification Strategy
# Click Save

# Ensure the agent is running.
On Nodes page, linux-node should have a green check

<h4>Setting up your repository</h4>
    • Fork https://github.com/opswerks-lab/node-webapp and clone it on the server instance.
# Go to: https://github.com/opswerks-lab/node-webapp
# Click Fork (top-right).
# Select your GitHub account as the destination.
# You now have your own copy under: https://github.com/&lt;your-username&gt;/node-webapp

# Jenkins server instance
$ cd ~
$ git clone https://github.com/&lt;your-username&gt;/node-webapp
$ cd node-webapp


    • In your GitHub account settings, go to Developer settings > Personal access tokens and create a token with repo access.
    Note: You’ll need this token to push changes to the repo. Alternatively, you can use SSH keys.
# Profile picture → Settings → Developer settings → Personal access tokens → Tokens (classic)
# Click Generate new token (classic).
# Give it a note (e.g., jenkins-push-token), set expiry as needed.
# Select scope: repo (full access to your repositories)
# Generate and copy the token somewhere safe (you can’t see it again after closing).


    • In Jenkins, under Manage Jenkins > Credentials, create a username:password credential with your GitHub username and the personal access token as password.
# Manage Jenkins → Credentials.
# Select (global) → Add Credentials.
# Fill in:
    • Kind: Username with password
    • Username: &lt;your GitHub username&gt;
    • Password: (paste your personal access token)
    • ID: (optional, e.g., github-access-token)
# Click OK.

<h4>Main Tasks</h4>
• Install the Docker Pipeline plugin.
Note: Restarting Jenkins might kill the Docker container, so you might need to re-run the Docker command to restart Jenkins.
# Manage Jenkins → Plugins → Available plugins
# Docker Pipeline
# Click Install without restart
# If restart occur:
    $ docker rm -f jenkins-server
    $ docker run -p 8080:8080 -v ~/jenkins_home:/var/jenkins_home -d --name jenkins-server jenkins/jenkins:lts-jdk17

• Create a pipeline named node-app.
# On Jenkins dashboard → New Item
# Enter name: node-app
# Select Pipeline
# Click OK

• Create a Jenkinsfile in the master/main branch of your forked node-webapp repo and reference it in your pipeline. Use the Git credentials you created. Do NOT define pipeline steps manually in Jenkins UI.
# Jenkins server
$ cd ~/node-webapp
$ vi Jenkinsfile
###
pipeline {
    agent { label 'linux-node' } // Force pipeline to run on your agent node

    stages {
        stage('Checkout') {
            steps {
                git branch: 'main',
                    credentialsId: 'github-access-token', // The ID you created for GitHub credentials
                    url: 'https://github.com/&lt;your-username&gt;/node-webapp.git'
            }
        }

        stage('Build Docker Image') {
            steps {
                script {
                    docker.build('node-webapp-image')
                }
            }
        }

        stage('Run Container') {
            steps {
                script {
                    docker.image('node-webapp-image').run('-d -p 3000:3000')
                }
            }
        }
    }
}
###
# Replace:
    • &lt;your-username&gt; with your GitHub username.
    • github-access-token with the exact credentials ID from Jenkins.
# Save and push
$ git add Jenkinsfile
$ git commit -m "Add Jenkinsfile for node-app pipeline"
$ git push origin main


• The pipeline should build the Dockerfile in the repo and run it on the agent.
• The pipeline must use the agent you set up.
Configure pipeline to use Jenkinsfile
[In the node-app job]
# Scroll to Pipeline section
# Definition: Pipeline script from SCM
# SCM: Git
# Repository URL: https://github.com/&lt;your-username&gt;/node-webapp.git
# Credentials: Select your GitHub credentials
# Branch Specifier: */main
# Click Save

Run the pipeline
# Click Build Now
# Jenkins will:
    • Checkout your repo
    • Build the Docker image from the Dockerfile in the repo
    • Run it on the linux-node agent


• Troubleshoot and fix any build issues. If none occur, consider it a bonus point.
# Docker not found → Install Docker on your agent:
    $ sudo apt update && sudo apt install -y docker.io
    $ sudo usermod -aG docker $USER
# (Then log out/in)

# Permission denied for docker.sock → Ensure Jenkins user on agent can run Docker:
    $ sudo usermod -aG docker jenkins
# (Then restart Jenkins agent)


<h4>Validation</h4>
• Visiting [IP of Agent]:3000 should show the running node-webapp. Achieving this means a perfect score.



<h4>Pipeline</h4>
###
pipeline {
    agent any
    stages {
        stage('Clone Repo') {
            steps {
                git(
                    url: 'https://github.com/&lt;your-username&gt;/node-webapp.git',
                    branch: 'main',
                    credentialsId: 'github-creds' // the ID you created in Jenkins
                )
            }
        }

        stage('Install Dependencies') {
            steps {
                sh 'npm install'
            }
        }

        stage('Run App') {
            steps {
                sh 'nohup npm start &'
            }
        }
    }
}
###

        
    </div>
  </div>

  <script>
    const correctPassword = "caramelo";

    function promptPassword() {
      const userInput = prompt("Enter password:");
      if (userInput === null) {
        // User clicked cancel
        document.body.innerHTML = "<p style='color:white; text-align:center; padding-top:20%; font-family: monospace;'>Access cancelled.</p>";
      } else if (userInput === correctPassword) {
        document.body.style.display = "flex";
      } else {
        alert("Incorrect password. Try again.");
        promptPassword();
      }
    }

    window.onload = promptPassword;
  </script>
</body>
</html>










